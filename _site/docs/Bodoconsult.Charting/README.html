<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Bodoconsult.Charting | Bodoconsult.AppInfrastructure </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Bodoconsult.Charting | Bodoconsult.AppInfrastructure ">
      
      
      <link rel="icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/RobertLeisner/Bodoconsult.AppInfrastructure/blob/main/docs/Bodoconsult.Charting/README.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../logo.svg" alt="Bodoconsult.AppInfrastructure">
            Bodoconsult.AppInfrastructure
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="bodoconsultcharting">Bodoconsult.Charting</h1>

<h1 id="what-does-bodoconsultcharting-library">What does Bodoconsult.Charting library</h1>
<p>Bodoconsult.Charting is a library for creating charts from database data. The workflow for using the library is generally as follows:</p>
<ol>
<li>Getting data as DataTable from a database</li>
<li>Create a ChartData object to make general settings for the chart and load the data from the DataTable as list of IChartItemData items</li>
<li>Create a ChartHandler and deliver the ChartData object to it</li>
<li>Export the data to a file</li>
</ol>
<p>To work properly the DataTable objects must have a certain logical structure depending on the type of chart you want to create.</p>
<blockquote>
<p><a href="#chart-data-input">Chart data input</a></p>
</blockquote>
<blockquote>
<p><a href="#style-the-charts">Style the charts</a></p>
</blockquote>
<blockquote>
<p><a href="#creating-charts">Creating charts</a></p>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#line-chart">Line charts</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#bar-chart">Bar chart</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#column-chart">Column chart</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#stacked-bar-chart">Stacked bar chart</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#stacked-column-chart">Stacked column chart</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#stacked-column-chart-100">Stacked column chart 100 percent</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#pie-chart">Pie chart</a></p>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p><a href="#point-chart-risk-return-chart-in-finance">Point chart</a></p>
</blockquote>
</blockquote>
<blockquote>
<p><a href="#using-bodoconsultcharting-in-a-di-container-environment">Using Bodoconsult.Charting in a DI container environment</a></p>
</blockquote>
<blockquote>
<p><a href="#extension-methods-for-charting">Extension methods for charting</a></p>
</blockquote>
<h1 id="how-to-use-the-library">How to use the library</h1>
<p>The source code contains NUnit test classes the following source code is extracted from. The samples below show the most helpful use cases for the library.</p>
<h1 id="chart-data-input">Chart data input</h1>
<p>All chart types require a IList<ichartitemdata> as input.</ichartitemdata></p>
<p>The following classes are implementing IChartItemData currently:</p>
<ul>
<li><p>ChartItemData</p>
</li>
<li><p>PieChartItemData</p>
</li>
<li><p>PointChartItemData</p>
</li>
</ul>
<p>See the description for each chart type below for the required type of data input.</p>
<h1 id="style-the-charts">Style the charts</h1>
<p>Chart styling is based on the class ChartStyle from the library Bodoconsult.App.Abstractions you can download via Nuget. See the following code fragments for how chart styling is done in the test project.</p>
<pre><code class="lang-csharp">public static class TestHelper
{
    ...
    
    /// &lt;summary&gt;
    /// Load a default style for the charts
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;chartData&quot;&gt;&lt;/param&gt;
    /// &lt;param name=&quot;highResolution&quot;&gt;&lt;/param&gt;
    public static void LoadDefaultChartStyle(ChartData chartData, bool highResolution = false)
    {

        var chartStyle = GlobalValues.DefaultTypography().ChartStyle;

        if (highResolution)
        {
            chartStyle.Width = 4500;
            chartStyle.Height = 2781;
            chartStyle.FontSize = 12;
        }

        chartStyle.CopyrightFontSizeDelta = 0.6F;
        chartStyle.BackgroundColor = Color.Transparent;
        //_chartStyle.AxisLineColor = Color.DarkBlue;

        //
        chartData.ChartStyle  = chartStyle;
        chartData.Copyright = &quot;(c) Testfirma&quot;;
    }
    
...
}
</code></pre>
<pre><code class="lang-csharp">public static class GlobalValues
{
    /// &lt;summary&gt;
    /// Get a elegant default typography
    /// &lt;/summary&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public static ITypography DefaultTypography()
    {
        var typography = new ElegantTypographyPageHeader(&quot;Calibri&quot;, &quot;Calibri&quot;, &quot;Calibri&quot;)
        {
            ChartStyle =
            {
                Width = 750,
                Height = 464,
                FontSize = 10,
                BackGradientStyle = GradientStyle.TopBottom,
            }
        };

        return typography;
    }
}
</code></pre>
<h1 id="creating-charts">Creating charts</h1>
<h2 id="line-chart">Line chart</h2>
<h3 id="sample-image">Sample image</h3>
<p><img src="../../images/StackedColumn100Chart.png" alt="Sample for stacked column chart 100%"></p>
<h3 id="chart-data">Chart data</h3>
<p>ChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Data items for line charts, stacked bar charts and others.
/// &lt;/summary&gt;
public class ChartItemData : IChartItemData
{
    /// &lt;summary&gt;
    /// Value for the x axis
    /// &lt;/summary&gt;
    public double XValue { get; set; }

    /// &lt;summary&gt;
    /// Value for the data series 1
    /// &lt;/summary&gt;
    public double YValue1 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 2
    /// &lt;/summary&gt;
    public double YValue2 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 3
    /// &lt;/summary&gt;
    public double YValue3 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 4
    /// &lt;/summary&gt;
    public double YValue4 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 5
    /// &lt;/summary&gt;
    public double YValue5 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 6
    /// &lt;/summary&gt;
    public double YValue6 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 7
    /// &lt;/summary&gt;
    public double YValue7 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 8
    /// &lt;/summary&gt;
    public double YValue8 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 9
    /// &lt;/summary&gt;
    public double YValue9 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 10
    /// &lt;/summary&gt;
    public double YValue10 { get; set; }

    /// &lt;summary&gt;
    /// Are x axis values dates?
    /// &lt;/summary&gt;
    public bool IsDate { get; set; }

    /// &lt;summary&gt;
    /// Label to show for the item. May be null. If null, the XValue is used as label.
    /// &lt;/summary&gt;
    public string Label  { get; set; }
}
</code></pre>
<h3 id="code">Code</h3>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_LineChart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteilwert&quot;,
    FileName = fileName,
    ChartType = ChartType.LineChart,
    //PaperColor = Color.Red
};

TestHelper.LoadDefaultChartStyle(data, HighResolution);

TestDataHelper.ChartSample(UseDatabase, data);

data.ChartStyle.XAxisNumberformat = &quot;dd.MM.yyyy&quot;;

data.PropertiesToUseForChart.Add(&quot;XValue&quot;);
data.PropertiesToUseForChart.Add(&quot;YValue1&quot;);
data.PropertiesToUseForChart.Add(&quot;YValue2&quot;);
data.PropertiesToUseForChart.Add(&quot;YValue3&quot;);

data.LabelsForSeries.Add(&quot;Aktien&quot;);
data.LabelsForSeries.Add(&quot;Renten&quot;);
data.LabelsForSeries.Add(&quot;Liquidit√§t&quot;);

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="bar-chart">Bar chart</h1>
<h2 id="sample-image-1">Sample image</h2>
<p><img src="../../images/BarChart.png" alt="Sample for bar chart"></p>
<h2 id="chart-data-1">Chart data</h2>
<p>ChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Data items for line charts, stacked bar charts and others.
/// &lt;/summary&gt;
public class ChartItemData : IChartItemData
{
    /// &lt;summary&gt;
    /// Value for the x axis
    /// &lt;/summary&gt;
    public double XValue { get; set; }

    /// &lt;summary&gt;
    /// Value for the data series 1
    /// &lt;/summary&gt;
    public double YValue1 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 2
    /// &lt;/summary&gt;
    public double YValue2 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 3
    /// &lt;/summary&gt;
    public double YValue3 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 4
    /// &lt;/summary&gt;
    public double YValue4 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 5
    /// &lt;/summary&gt;
    public double YValue5 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 6
    /// &lt;/summary&gt;
    public double YValue6 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 7
    /// &lt;/summary&gt;
    public double YValue7 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 8
    /// &lt;/summary&gt;
    public double YValue8 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 9
    /// &lt;/summary&gt;
    public double YValue9 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 10
    /// &lt;/summary&gt;
    public double YValue10 { get; set; }

    /// &lt;summary&gt;
    /// Are x axis values dates?
    /// &lt;/summary&gt;
    public bool IsDate { get; set; }

    /// &lt;summary&gt;
    /// Label to show for the item. May be null. If null, the XValue is used as label.
    /// &lt;/summary&gt;
    public string Label  { get; set; }
}
</code></pre>
<h2 id="code-1">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_BarChart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteil in %&quot;,

    FileName = fileName,
    ChartType = ChartType.BarChart,

};

TestHelper.LoadDefaultChartStyle(data, HighResolution);

TestDataHelper.BarChartSample(UseDatabase, data);

data.ChartStyle.XAxisNumberformat = &quot;0.00&quot;;

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="column-chart">Column chart</h1>
<h2 id="sample-image-2">Sample image</h2>
<p><img src="../../images/ColumnChart.png" alt="Sample for column chart"></p>
<h2 id="chart-data-2">Chart data</h2>
<p>ChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Data items for line charts, stacked bar charts and others.
/// &lt;/summary&gt;
public class ChartItemData : IChartItemData
{
    /// &lt;summary&gt;
    /// Value for the x axis
    /// &lt;/summary&gt;
    public double XValue { get; set; }

    /// &lt;summary&gt;
    /// Value for the data series 1
    /// &lt;/summary&gt;
    public double YValue1 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 2
    /// &lt;/summary&gt;
    public double YValue2 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 3
    /// &lt;/summary&gt;
    public double YValue3 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 4
    /// &lt;/summary&gt;
    public double YValue4 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 5
    /// &lt;/summary&gt;
    public double YValue5 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 6
    /// &lt;/summary&gt;
    public double YValue6 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 7
    /// &lt;/summary&gt;
    public double YValue7 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 8
    /// &lt;/summary&gt;
    public double YValue8 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 9
    /// &lt;/summary&gt;
    public double YValue9 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 10
    /// &lt;/summary&gt;
    public double YValue10 { get; set; }

    /// &lt;summary&gt;
    /// Are x axis values dates?
    /// &lt;/summary&gt;
    public bool IsDate { get; set; }

    /// &lt;summary&gt;
    /// Label to show for the item. May be null. If null, the XValue is used as label.
    /// &lt;/summary&gt;
    public string Label  { get; set; }
}
</code></pre>
<h2 id="code-2">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_ColumnChart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{

    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteil in %&quot;,


    FileName = fileName,
    ChartType = ChartType.ColumnChart,

};

TestHelper.LoadDefaultChartStyle(data, HighResolution);
TestDataHelper.BarChartSample(UseDatabase, data);

data.ChartStyle.YAxisNumberformat = &quot;0.00&quot;;

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();

TestHelper.StartFile(fileName);
</code></pre>
<h1 id="stacked-bar-chart">Stacked bar chart</h1>
<h2 id="sample-image-3">Sample image</h2>
<p><img src="../../images/StackedBarChart.png" alt="Sample for stacked bar chart"></p>
<h2 id="chart-data-3">Chart data</h2>
<p>ChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Data items for line charts, stacked bar charts and others.
/// &lt;/summary&gt;
public class ChartItemData : IChartItemData
{
    /// &lt;summary&gt;
    /// Value for the x axis
    /// &lt;/summary&gt;
    public double XValue { get; set; }

    /// &lt;summary&gt;
    /// Value for the data series 1
    /// &lt;/summary&gt;
    public double YValue1 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 2
    /// &lt;/summary&gt;
    public double YValue2 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 3
    /// &lt;/summary&gt;
    public double YValue3 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 4
    /// &lt;/summary&gt;
    public double YValue4 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 5
    /// &lt;/summary&gt;
    public double YValue5 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 6
    /// &lt;/summary&gt;
    public double YValue6 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 7
    /// &lt;/summary&gt;
    public double YValue7 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 8
    /// &lt;/summary&gt;
    public double YValue8 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 9
    /// &lt;/summary&gt;
    public double YValue9 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 10
    /// &lt;/summary&gt;
    public double YValue10 { get; set; }

    /// &lt;summary&gt;
    /// Are x axis values dates?
    /// &lt;/summary&gt;
    public bool IsDate { get; set; }

    /// &lt;summary&gt;
    /// Label to show for the item. May be null. If null, the XValue is used as label.
    /// &lt;/summary&gt;
    public string Label  { get; set; }
}
</code></pre>
<h2 id="code-3">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_Db_StackedBarChart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteilswert&quot;,
    FileName = fileName,
    ChartType = ChartType.StackedBarChart,

};

TestHelper.LoadDefaultChartStyle(data);

var dt = TestHelper.GetDataTable(&quot;StackedBarChart.xml&quot;);
ChartUtility.DataTableToChartItemData(dt, &quot;&quot;, data);

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="stacked-column-chart">Stacked column chart</h1>
<h2 id="sample-image-4">Sample image</h2>
<p><img src="../../images/StackedColumnChart.png" alt="Sample for stacked column chart"></p>
<h2 id="chart-data-4">Chart data</h2>
<p>ChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Data items for line charts, stacked bar charts and others.
/// &lt;/summary&gt;
public class ChartItemData : IChartItemData
{
    /// &lt;summary&gt;
    /// Value for the x axis
    /// &lt;/summary&gt;
    public double XValue { get; set; }

    /// &lt;summary&gt;
    /// Value for the data series 1
    /// &lt;/summary&gt;
    public double YValue1 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 2
    /// &lt;/summary&gt;
    public double YValue2 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 3
    /// &lt;/summary&gt;
    public double YValue3 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 4
    /// &lt;/summary&gt;
    public double YValue4 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 5
    /// &lt;/summary&gt;
    public double YValue5 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 6
    /// &lt;/summary&gt;
    public double YValue6 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 7
    /// &lt;/summary&gt;
    public double YValue7 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 8
    /// &lt;/summary&gt;
    public double YValue8 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 9
    /// &lt;/summary&gt;
    public double YValue9 { get; set; }
    /// &lt;summary&gt;
    /// Value for the data series 10
    /// &lt;/summary&gt;
    public double YValue10 { get; set; }

    /// &lt;summary&gt;
    /// Are x axis values dates?
    /// &lt;/summary&gt;
    public bool IsDate { get; set; }

    /// &lt;summary&gt;
    /// Label to show for the item. May be null. If null, the XValue is used as label.
    /// &lt;/summary&gt;
    public string Label  { get; set; }
}
</code></pre>
<h2 id="code-4">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_Db_StackedColumnChart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteilswert&quot;,
    FileName = fileName,
    ChartType = ChartType.StackedColumnChart,

};

TestHelper.LoadDefaultChartStyle(data);

var dt = TestHelper.GetDataTable(&quot;StackedColumnChart.xml&quot;);
ChartUtility.DataTableToChartItemData(dt, &quot;&quot;, data);

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="stacked-column-chart-100">Stacked column chart 100%</h1>
<h2 id="sample-image-5">Sample image</h2>
<p><img src="../../images/StackedColumn100Chart.png" alt="Sample for stacked column chart 100%"></p>
<h2 id="chart-data-5">Chart data</h2>
<p>ChartItemData class</p>
<pre><code class="lang-csharp">
</code></pre>
<h2 id="code-5">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_Db_StackedColumn100Chart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteilswert&quot;,
    FileName = fileName,
    ChartType = ChartType.StackedColumn100Chart,
};

TestHelper.LoadDefaultChartStyle(data);

var dt = TestHelper.GetDataTable(&quot;StackedColumnChart.xml&quot;);
ChartUtility.DataTableToChartItemData(dt, &quot;&quot;, data);

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="pie-chart">Pie chart</h1>
<h2 id="sample-image-6">Sample image</h2>
<p><img src="../../images/PieChart.png" alt="Sample for pie chart"></p>
<h2 id="chart-data-6">Chart data</h2>
<p>PieChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Item data for a pie chart
/// &lt;/summary&gt;
public class PieChartItemData: IChartItemData
{
    /// &lt;summary&gt;
    /// X axis value
    /// &lt;/summary&gt;
    public string XValue { get; set; }

    /// &lt;summary&gt;
    /// Value for the series
    /// &lt;/summary&gt;
    public double YValue { get; set; }
}
</code></pre>
<h2 id="code-6">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_PieChart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    YLabelText = &quot;Anteil in %&quot;,
    FileName = fileName,
    ChartType = ChartType.PieChart,
};

TestHelper.LoadDefaultChartStyle(data, HighResolution);

TestDataHelper.PieChartSample(UseDatabase, data);

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="point-chart-risk-return-chart-in-finance">Point chart (risk-return-chart in finance)</h1>
<h2 id="sample-image-7">Sample image</h2>
<p><img src="../../images/PointChart.png" alt="Sample for point chart"></p>
<h2 id="chart-data-7">Chart data</h2>
<p>PointChartItemData class</p>
<pre><code class="lang-csharp">/// &lt;summary&gt;
/// Point item to show in a point chart
/// &lt;/summary&gt;
public class PointChartItemData: IChartItemData
{
    /// &lt;summary&gt;
    /// X axis value
    /// &lt;/summary&gt;
    public double XValue { get; set; }

    /// &lt;summary&gt;
    /// Y axis value
    /// &lt;/summary&gt;
    public double YValue { get; set; }

    /// &lt;summary&gt;
    /// Label for the data point
    /// &lt;/summary&gt;
    public string Label { get; set; }

    /// &lt;summary&gt;
    /// Color index for the data point
    /// &lt;/summary&gt;
    public TypoColor Color { get; set; }
}
</code></pre>
<h2 id="code-7">Code</h2>
<pre><code class="lang-csharp">const string fileName = @&quot;d:\temp\ScottPlott_Db_StackedColumn100Chart.png&quot;;

if (File.Exists(fileName)) File.Delete(fileName);

var data = new ChartData
{
    Title = &quot;Test portfolio&quot;,
    Copyright = &quot;Testfirma&quot;,
    XLabelText = &quot;Anlageklassen&quot;,
    YLabelText = &quot;Anteilswert&quot;,
    FileName = fileName,
    ChartType = ChartType.StackedColumn100Chart,
};

TestHelper.LoadDefaultChartStyle(data);

var dt = TestHelper.GetDataTable(&quot;StackedColumnChart.xml&quot;);
ChartUtility.DataTableToChartItemData(dt, &quot;&quot;, data);

var bitmapServiceFactory = new BitmapServiceFactory();

var x = new ChartHandler(data, bitmapServiceFactory);

x.Export();
</code></pre>
<h1 id="stock-chart">Stock chart</h1>
<p>ToDo</p>
<h1 id="using-bodoconsultcharting-in-a-di-container-environment">Using Bodoconsult.Charting in a DI container environment</h1>
<pre><code class="lang-csharp">// Arrange 
var di = new DiContainer();

// load other providers here if necessary
...

// Act  
var provider = new ChartingDiContainerServiceProvider();
provider.AddServices(di);

// Load more other providers here if necessary
...

// Now build the container
di.BuildServiceProvider();

// Assert
var result = di.Get&lt;IChartHandlerFactory&gt;();
Assert.That(result, Is.Not.Null);

// Use DI
var data = new ChartData(); // configuring chartdata as required has to be added here

var ch = result.CreateInstance(data); // Create a chart handler instance now

ch.Export(); // Export the chart to PNG file
</code></pre>
<h1 id="extension-methods-for-charting">Extension methods for charting</h1>
<p>For System.Data.DataTables instances there are helpful methods for converting them to chart input data. See the following methods:</p>
<ul>
<li><p>ToChartItemData()</p>
</li>
<li><p>ToPieChartItemData()</p>
</li>
<li><p>ToPointChartItemData()</p>
</li>
</ul>
<p>Alternatively you can use the class ChartUtility class.</p>
<p>Column names of the DataTable instances are used as labels for the legend (if applicable).</p>
<h2 id="tochartitemdata">ToChartItemData()</h2>
<p>ToDo: add description for DataTable</p>
<h2 id="topiechartitemdata">ToPieChartItemData()</h2>
<p>ToDo: add description for DataTable</p>
<h2 id="topointchartitemdata">ToPointChartItemData()</h2>
<p>ToDo: add description for DataTable</p>
<h1 id="about-us">About us</h1>
<p>Bodoconsult <a href="http://www.bodoconsult.de">http://www.bodoconsult.de</a> is a Munich based software company from Germany.</p>
<p>Robert Leisner is senior software developer at Bodoconsult. See his profile on <a href="http://www.bodoconsult.de/Curriculum_vitae_Robert_Leisner.pdf">http://www.bodoconsult.de/Curriculum_vitae_Robert_Leisner.pdf</a>.</p>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/RobertLeisner/Bodoconsult.AppInfrastructure/blob/main/docs/Bodoconsult.Charting/README.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
